<script 
    src="https://www.dukelearntoprogram.com/course1/common/js/image/SimpleImage.js" >
</script>
<html><head>
    <style>body
{
     background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
	background-size: 400% 400%;
	animation: gradient 15s ease infinite;
}

@keyframes gradient {
	0% {
		background-position: 0% 25%;
	}
	50% {
		background-position: 100% 50%;
	}
	100% {
		background-position: 0% 50%;
	}
}
h1
{
  color:AliceBlue;
  text-align:center;
}
canvas
{
  width:300px;
  height:400px;
  border:2px dotted;
  color:AliceBlue;
  border-radius:25px;
   padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
    width: 800px;
  
}
h2
{
  color:AliceBlue;
}
input{
  color:AliceBlue;
  border-radius:9px;
  font-size: 10pt;
  color:slateblue;
}
input:hover
{
  
  text-decoration:none;
  border-radius:9px;
  font-size: 11pt;
  box-sizing: inherit;
  transition-duration: .6s;
  transition-timing-function: ease-in-out
    transform: scale(1.1);
}

</style></head>
<h1>Filter Fun</h1>

<canvas id="can">
</canvas>

<h2>Load Image</h2>

<input type="file" multiple="false" accept="image/*" id="image" onchange="upload()">
<h2>Choose Filter</h2>

<input type= "button" value="GrayScale" id="gray" onclick="makeGray()">

  <input type= "button" value="Red Filter" id="red" onclick="makeRed()">
  <input type="button" id="green" value="Green filter" onclick="makeGreen()">
  <input type="button" id="blue" value="Blue Filter" onclick="makeBlue()">
  <input type="button" id="rainbow" value=" Rainbow effect" onclick="makeRainbow()">
  <input type="button" id="blur" value="Blur effect" onclick="makeBlur()">
<p>
  <p><input type="button" id="reset" value="Reset Image" onclick="upload()">
 <input type="button" id="clsClear" value="Clear Canvas" onclick="clearImage()">
</html>
<script>var image=null;
var imgcanvas;
var blurValue=50;
var blur=0.5;
function upload(){
  imgcanvas=document.getElementById("can");
  var fileinput=document.getElementById("image");
image =  new SimpleImage(fileinput);
  image.drawTo(imgcanvas);
}

function makeGray(){
  if(image==null||! image.complete()){
    alert="Image Not Loaded";
    return;
  }
  for(var pixel of image.values()){
    var avg = (pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3;
    pixel.setRed(avg);
    pixel.setGreen(avg);
    pixel.setBlue(avg);
  }
  imgcanvas = document.getElementById("can");
  image.drawTo(imgcanvas);
}

function makeGreen(){
  if(image==null||! image.complete()){
    alert="Image Not Loaded";
    return;
  }
  for(var pixel of image.values()){
    var avg = ((pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3);
    if (avg < 128){
      pixel.setRed(0);
      pixel.setBlue(0);
      pixel.setGreen(2*avg);
    } 
    else{
      pixel.setRed(2*avg-255);
      pixel.setGreen(200);
      pixel.setBlue(2*avg-255);
    }
  }
  imgcanvas = document.getElementById("can");
  image.drawTo(imgcanvas);
}

function makeRed(){
  if(image==null||! image.complete()){
    alert="Image Not Loaded";
    return;
  }
  for(var pixel of image.values()){
    var avg = ((pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3);
    if (avg < 128){
      pixel.setRed(2*avg);
      pixel.setBlue(0);
      pixel.setGreen(0);
    } 
    else{
      pixel.setRed(200);
      pixel.setGreen(2*avg-255);
      pixel.setBlue(2*avg-255);
    }
  }
  imgcanvas = document.getElementById("can");
  image.drawTo(imgcanvas);
}

function makeBlue(){
  if(image==null||! image.complete()){
    alert="Image Not Loaded";
    return;
  }
  for(var pixel of image.values()){
    var avg = (pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3;
    if (avg < 143){
      pixel.setRed(0);
      pixel.setBlue(2*avg);
      pixel.setGreen(0);
    } 
    else{
      pixel.setRed(2*avg-255);
      pixel.setGreen(2*avg-255);
      pixel.setBlue(200);
    }
  }
  imgcanvas = document.getElementById("can");
  image.drawTo(imgcanvas);
}

function makeRainbow(){
  if(image==null|| !image.complete()){
    alert("Image not uploaded");
    return;
  }
  for(var pixel of image.values()){
    var avg=(pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3;
    var y = pixel.getY();
    var h = image.getHeight();
    
    if(y < h/7){
      if(avg < 128){
        pixel.setRed(2*avg);
        pixel.setGreen(0);
        pixel.setBlue(0);
      }
      else{
        pixel.setRed(255);
        pixel.setGreen(2*avg - 255);
        pixel.setBlue(2*avg - 255);
      }
    }
    else if(y >= h/7 && y < (2*h)/7){
      if(avg < 128){
        pixel.setRed(2*avg);
        pixel.setGreen(0.8*avg);
        pixel.setBlue(0);
      }
      else{
        pixel.setRed(255);
        pixel.setGreen(1.2*avg - 51);
        pixel.setBlue(2*avg - 255);
      }
    }
    else if(y >= (2*h)/7 && y < (3*h)/7){
      if(avg < 128){
        pixel.setRed(2*avg);
        pixel.setGreen(2*avg);
        pixel.setBlue(0);
      }
      else{
        pixel.setRed(255);
        pixel.setGreen(255);
        pixel.setBlue(2*avg - 255);
      }
    }
    else if(y >= (3*h)/7 && y < (4*h)/7){
      if(avg < 128){
        pixel.setRed(0);
        pixel.setGreen(2*avg);
        pixel.setBlue(0);
      }
      else{
        pixel.setRed(2*avg - 255);
        pixel.setGreen(255);
        pixel.setBlue(2*avg - 255);
      }
    }
    else if(y >= (4*h)/7 && y < (5*h)/7){
      if(avg < 128){
        pixel.setRed(0);
        pixel.setGreen(0);
        pixel.setBlue(2*avg);
      }
      else{
        pixel.setRed(2*avg - 255);
        pixel.setGreen(2*avg - 255);
        pixel.setBlue(255);
      }
    }
    else if(y >= (5*h)/7 && y < (6*h)/7){
      if(avg < 128){
        pixel.setRed(0.8*avg);
        pixel.setGreen(0);
        pixel.setBlue(2*avg);
      }
      else{
        pixel.setRed(1.2*avg - 51);
        pixel.setGreen(2*avg - 255);
        pixel.setBlue(255);
      }
    }
    else if(y >= (6*h)/7 && y <= h){
      if(avg < 128){
        pixel.setRed(1.6*avg);
        pixel.setGreen(0);
        pixel.setBlue(1.6*avg);
      }
      else{
        pixel.setRed(0.4*avg + 153);
        pixel.setGreen(2*avg - 255);
        pixel.setBlue(0.4*avg + 153);
      }
    }
  }
  imgcanvas = document.getElementById("can");
  image.drawTo(imgcanvas);
}

function makeBlur(){
  if(image == null || !image.complete()){
    alert("Image not uploaded");
    return;
  }
  for(var pixel of image.values()){
    if(Math.random() > blur){
      var x = pixel.getX();
      var y = pixel.getY();
      
      var newx=x + (2*Math.floor(Math.random()*(blurValue + 1)) - blurValue);
      var newy = y + (2*Math.floor(Math.random()*(blurValue + 1)) - blurValue);
      
      if((newx < image.getWidth() && newx >= 0) && (newy < image.getHeight() && newy >= 0)){
        var newpixel = image.getPixel(newx, newy);
        image.setPixel(x,y,newpixel);
      }
    }
  }
  imgcanvas = document.getElementById("can");
  image.drawTo(imgcanvas);
}

function clearImage() {
  var imgTemp = document.getElementById("can");
  var clearImg = imgTemp.getContext("2d");
  clearImg.clearRect(0, 0, imgTemp.width, imgTemp.height);
}
</script>